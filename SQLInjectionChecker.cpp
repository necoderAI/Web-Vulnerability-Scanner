#include "SQLInjectionChecker.hpp"
#include <regex>

void SQLInjectionChecker::check(const std::vector<std::string>& lines, const std::string& filePath, Logger& logger) {
    std::regex sqlQuery("SELECT .* FROM .* WHERE .*");
    std::regex unsafeVariable("\\$_GET|\\$_POST|\\$_REQUEST");

    for (size_t i = 0; i < lines.size(); ++i) {
        if (std::regex_search(lines[i], sqlQuery) && std::regex_search(lines[i], unsafeVariable)) {
            logVulnerability(logger, filePath, i + 1, "SQL Injection", "Реальная");
        }
        else if (std::regex_search(lines[i], sqlQuery)) {
            logVulnerability(logger, filePath, i + 1, "SQL Injection", "Потенциальная");
        }
    }
}
