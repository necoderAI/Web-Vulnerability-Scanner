#include "XSSChecker.hpp"
#include <regex>

void XSSChecker::check(const std::vector<std::string>& lines, const std::string& filePath, Logger& logger) {
    std::regex scriptTag("<script>");
    std::regex onErrorAttr("onerror=");

    for (size_t i = 0; i < lines.size(); ++i) {
        if (std::regex_search(lines[i], scriptTag)) {
            logVulnerability(logger, filePath, i + 1, "XSS", "Реальная");
        }
        else if (std::regex_search(lines[i], onErrorAttr)) {
            logVulnerability(logger, filePath, i + 1, "XSS", "Потенциальная");
        }
    }
}
