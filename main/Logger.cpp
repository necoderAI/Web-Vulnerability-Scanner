#include "Logger.hpp"

Logger::Logger(const std::string& fileName, Localization& localization) : localization(localization) {
    logFile.open(fileName, std::ios::out);
    if (!logFile.is_open()) {
        throw std::runtime_error(localization.getMessage("open_log_error"));
    }
}

Logger::~Logger() {
    if (logFile.is_open()) {
        logFile.close();
    }
}

void Logger::log(const std::string& filePath, int lineNumber, const std::string& vulnerabilityType, const std::string& severity) {
    logFile << localization.getMessage("log_file") << ": " << filePath
        << ", " << localization.getMessage("log_line") << ": " << lineNumber
        << ", " << localization.getMessage("log_vulnerability") << ": " << vulnerabilityType
        << ", " << localization.getMessage("log_type") << ": " << severity << std::endl;
}
