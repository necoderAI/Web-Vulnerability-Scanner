#include "CommandInjectionChecker.hpp"
#include <regex>

void CommandInjectionChecker::check(const std::vector<std::string>& lines, const std::string& filePath, Logger& logger) {
    std::regex dangerousFunctions("system\\(|exec\\(|popen\\(|shell_exec\\(");
    for (size_t i = 0; i < lines.size(); ++i) {
        if (std::regex_search(lines[i], dangerousFunctions)) {
            logVulnerability(logger, filePath, i + 1, "Command Injection", "ואכםא");
        }
    }
}
